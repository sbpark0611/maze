Using cpu device
tot num of params: 623067
[2024-02-17 13:59:47,684][absl][WARNING] - Cannot set velocity on Entity with no free joint.
Logging to /Users/sangbin/maze/outputs/2024-02-17/13-59-42/wandb/run-20240217_135945-682avmtq/files/682avmtq/PPO_1
---------------------------
| time/              |    |
|    fps             | 11 |
|    iterations      | 1  |
|    time_elapsed    | 5  |
|    total_timesteps | 64 |
---------------------------
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 2            |
|    time_elapsed            | 79           |
|    total_timesteps         | 128          |
| train/                     |              |
|    approx_kl               | 0.015366754  |
|    clip_fraction           | 0.222        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0003409802 |
|    embedding_weight_stddev | 0.06655526   |
|    entropy_loss            | -1.76        |
|    explained_variance      | 0.147        |
|    grad_norm               | 0.075        |
|    learning_rate           | 0.0005       |
|    loss                    | -0.00262     |
|    n_updates               | 5            |
|    policy_gradient_loss    | -0.00625     |
|    value_loss              | 0.000498     |
---------------------------------------------
------------------------------------------------
| time/                      |                 |
|    fps                     | 1               |
|    iterations              | 3               |
|    time_elapsed            | 154             |
|    total_timesteps         | 192             |
| train/                     |                 |
|    approx_kl               | 0.014789371     |
|    clip_fraction           | 0.209           |
|    clip_range              | 0.2             |
|    embedding_weight_mean   | -0.000105141175 |
|    embedding_weight_stddev | 0.06683415      |
|    entropy_loss            | -1.77           |
|    explained_variance      | -1.73           |
|    grad_norm               | 0.0392          |
|    learning_rate           | 0.0005          |
|    loss                    | -0.0143         |
|    n_updates               | 10              |
|    policy_gradient_loss    | -0.00916        |
|    value_loss              | 8.28e-05        |
------------------------------------------------
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 4            |
|    time_elapsed            | 227          |
|    total_timesteps         | 256          |
| train/                     |              |
|    approx_kl               | 0.015318797  |
|    clip_fraction           | 0.381        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0020228599 |
|    embedding_weight_stddev | 0.06712855   |
|    entropy_loss            | -1.74        |
|    explained_variance      | 0.16         |
|    grad_norm               | 0.0158       |
|    learning_rate           | 0.0005       |
|    loss                    | -0.00783     |
|    n_updates               | 15           |
|    policy_gradient_loss    | -0.0012      |
|    value_loss              | 0.000235     |
---------------------------------------------
--------------------------------------------
| time/                      |             |
|    fps                     | 1           |
|    iterations              | 5           |
|    time_elapsed            | 301         |
|    total_timesteps         | 320         |
| train/                     |             |
|    approx_kl               | 0.010463323 |
|    clip_fraction           | 0.109       |
|    clip_range              | 0.2         |
|    embedding_weight_mean   | 0.001439843 |
|    embedding_weight_stddev | 0.06675366  |
|    entropy_loss            | -1.75       |
|    explained_variance      | 0.795       |
|    grad_norm               | 0.0357      |
|    learning_rate           | 0.0005      |
|    loss                    | -0.00287    |
|    n_updates               | 20          |
|    policy_gradient_loss    | 0.00117     |
|    value_loss              | 0.000207    |
--------------------------------------------
Traceback (most recent call last):
  File "/Users/sangbin/maze/train_epn_3d.py", line 92, in <module>
    main()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/Users/sangbin/maze/train_epn_3d.py", line 79, in main
    model.learn(total_timesteps=cfg.optim.total_timesteps, callback=callback)
  File "/Users/sangbin/maze/ppo/epn/epn.py", line 509, in learn
    self.train()
  File "/Users/sangbin/maze/ppo/epn/epn.py", line 332, in train
    values, log_prob, entropy = self.policy.evaluate_actions(
  File "/Users/sangbin/maze/ppo/epn/policies.py", line 190, in evaluate_actions
    combined_embedding = self.model(memory, obs)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/sangbin/maze/ppo/epn/model.py", line 79, in forward
    new_states = self.image_embedding_conv(memory_image[i])
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
KeyboardInterrupt