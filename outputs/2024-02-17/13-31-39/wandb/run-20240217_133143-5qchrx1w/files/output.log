Using cpu device
tot num of params: 623067
_pick_new_target
[2024-02-17 13:31:45,482][absl][WARNING] - Cannot set velocity on Entity with no free joint.
Logging to /Users/sangbin/maze/outputs/2024-02-17/13-31-39/wandb/run-20240217_133143-5qchrx1w/files/5qchrx1w/PPO_1
---------------------------
| time/              |    |
|    fps             | 11 |
|    iterations      | 1  |
|    time_elapsed    | 5  |
|    total_timesteps | 64 |
---------------------------
0.0004048255 0.06666169
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 2            |
|    time_elapsed            | 78           |
|    total_timesteps         | 128          |
| train/                     |              |
|    approx_kl               | 0.0224592    |
|    clip_fraction           | 0.197        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0004048255 |
|    embedding_weight_stddev | 0.06666169   |
|    entropy_loss            | -1.76        |
|    explained_variance      | 0.636        |
|    grad_norm               | 0.0486       |
|    learning_rate           | 0.0005       |
|    loss                    | 0.00318      |
|    n_updates               | 5            |
|    policy_gradient_loss    | -0.00495     |
|    value_loss              | 0.00035      |
---------------------------------------------
0.0009687443 0.067318864
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 3            |
|    time_elapsed            | 150          |
|    total_timesteps         | 192          |
| train/                     |              |
|    approx_kl               | 0.031499363  |
|    clip_fraction           | 0.35         |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0009687443 |
|    embedding_weight_stddev | 0.067318864  |
|    entropy_loss            | -1.73        |
|    explained_variance      | -1.12        |
|    grad_norm               | 0.0578       |
|    learning_rate           | 0.0005       |
|    loss                    | 0.00251      |
|    n_updates               | 10           |
|    policy_gradient_loss    | -0.00735     |
|    value_loss              | 9.76e-05     |
---------------------------------------------
0.0011586501 0.06753823
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 4            |
|    time_elapsed            | 221          |
|    total_timesteps         | 256          |
| train/                     |              |
|    approx_kl               | 0.040111903  |
|    clip_fraction           | 0.409        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0011586501 |
|    embedding_weight_stddev | 0.06753823   |
|    entropy_loss            | -1.73        |
|    explained_variance      | 0.504        |
|    grad_norm               | 0.37         |
|    learning_rate           | 0.0005       |
|    loss                    | 0.12         |
|    n_updates               | 15           |
|    policy_gradient_loss    | 0.0343       |
|    value_loss              | 0.00376      |
---------------------------------------------
0.0014129136 0.068505734
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 5            |
|    time_elapsed            | 293          |
|    total_timesteps         | 320          |
| train/                     |              |
|    approx_kl               | 0.021887785  |
|    clip_fraction           | 0.306        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0014129136 |
|    embedding_weight_stddev | 0.068505734  |
|    entropy_loss            | -1.75        |
|    explained_variance      | -2.57        |
|    grad_norm               | 0.147        |
|    learning_rate           | 0.0005       |
|    loss                    | -0.0457      |
|    n_updates               | 20           |
|    policy_gradient_loss    | -0.0261      |
|    value_loss              | 0.000252     |
---------------------------------------------
0.0019109753 0.06913368
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 6            |
|    time_elapsed            | 367          |
|    total_timesteps         | 384          |
| train/                     |              |
|    approx_kl               | 0.039604776  |
|    clip_fraction           | 0.422        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0019109753 |
|    embedding_weight_stddev | 0.06913368   |
|    entropy_loss            | -1.73        |
|    explained_variance      | -2.02        |
|    grad_norm               | 0.0379       |
|    learning_rate           | 0.0005       |
|    loss                    | -0.00787     |
|    n_updates               | 25           |
|    policy_gradient_loss    | -0.0101      |
|    value_loss              | 0.000311     |
---------------------------------------------
0.0020632276 0.06979034
_pick_new_target
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 7            |
|    time_elapsed            | 439          |
|    total_timesteps         | 448          |
| train/                     |              |
|    approx_kl               | 0.07493073   |
|    clip_fraction           | 0.494        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0020632276 |
|    embedding_weight_stddev | 0.06979034   |
|    entropy_loss            | -1.6         |
|    explained_variance      | -6.05        |
|    grad_norm               | 0.0176       |
|    learning_rate           | 0.0005       |
|    loss                    | 0.0111       |
|    n_updates               | 30           |
|    policy_gradient_loss    | -0.00697     |
|    value_loss              | 0.000792     |
---------------------------------------------
0.0024978325 0.07139274
---------------------------------------------
| time/                      |              |
|    fps                     | 1            |
|    iterations              | 8            |
|    time_elapsed            | 511          |
|    total_timesteps         | 512          |
| train/                     |              |
|    approx_kl               | 0.21996158   |
|    clip_fraction           | 0.662        |
|    clip_range              | 0.2          |
|    embedding_weight_mean   | 0.0024978325 |
|    embedding_weight_stddev | 0.07139274   |
|    entropy_loss            | -1.43        |
|    explained_variance      | -0.00225     |
|    grad_norm               | 0.032        |
|    learning_rate           | 0.0005       |
|    loss                    | -0.0194      |
|    n_updates               | 35           |
|    policy_gradient_loss    | -0.597       |
|    value_loss              | 4.2          |
---------------------------------------------
-0.0007464299 0.07120482
----------------------------------------------
| time/                      |               |
|    fps                     | 0             |
|    iterations              | 9             |
|    time_elapsed            | 582           |
|    total_timesteps         | 576           |
| train/                     |               |
|    approx_kl               | 0.2588733     |
|    clip_fraction           | 0.634         |
|    clip_range              | 0.2           |
|    embedding_weight_mean   | -0.0007464299 |
|    embedding_weight_stddev | 0.07120482    |
|    entropy_loss            | -0.911        |
|    explained_variance      | 0.111         |
|    grad_norm               | 1.41          |
|    learning_rate           | 0.0005        |
|    loss                    | -1.19         |
|    n_updates               | 40            |
|    policy_gradient_loss    | -0.617        |
|    value_loss              | 0.192         |
----------------------------------------------
Traceback (most recent call last):
  File "/Users/sangbin/maze/train_epn_3d.py", line 92, in <module>
    main()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/Users/sangbin/maze/train_epn_3d.py", line 79, in main
    model.learn(total_timesteps=cfg.optim.total_timesteps, callback=callback)
  File "/Users/sangbin/maze/ppo/epn/epn.py", line 510, in learn
    self.train()
  File "/Users/sangbin/maze/ppo/epn/epn.py", line 319, in train
    for rollout_data in self.rollout_buffer.get(self.batch_size):
  File "/Users/sangbin/maze/ppo/epn/buffers.py", line 78, in get
    yield self._get_samples(batch_inds)
  File "/Users/sangbin/maze/ppo/epn/buffers.py", line 118, in _get_samples
    memory[key] = obs.squeeze(-1)
KeyboardInterrupt